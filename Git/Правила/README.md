Правила работы с Git
====================

# Сразу о главном
1. Сделали задачу - сразу закоммитили и запушили.
2. В конце рабочего дня, даже если функционал не готов - коммитим, что есть, пушим.
3. Не нужно держать днями на своей dev площадке много незакоммиченного кода, о котором никто не знает, который любой может случайно затереть - и все ваши усилия будут потрачены зря.

# Ставим git
Centos 6-7
```sh 
rpm -Uvh http://opensource.wandisco.com/centos/7/git/x86_64/wandisco-git-release-7-1.noarch.rpm
rpm -Uvh http://opensource.wandisco.com/centos/6/git/x86_64/wandisco-git-release-6-1.src.rpm
yum install git
```

Debian
```sh 
apt-get install git
```
# Настройки сервера
Всегда ставим git в папку выше директории сайта:
```sh 
$ git init --separate-git-dir /var/www/site/data/www/site.ru.git
```
настраиваем:
```sh 
$ git config color.ui true
$ git config core.filemode false
$ git config core.autocrlf input
```

# Начало работы
Перед тем, как начать работу с git на нашей площадке, необходимо сгенерировать себе приватный и публичный ключи. Для этого подключаемся к нашему серверу и выполняем команду:
```sh
ssh-keygen -t rsa -b 4096 -C «your_email@example.com»
```
Вместо пароля можно оставить пустую строку, просто нажав Enter, чтобы не вводить его постоянно. В домашнем каталоге должны появиться файлы ```sh~/.id_rsa``` и ```sh~/.id_rsa.pub```. Нужно скопировать целиком содержимое последнего (это просто текст, бех каких-либо пробелов и переновос) и вставиь в web-интерфейс git, с которым вам предстоит работать,к примеру, в наш GitLab по адресу https://gitlab.com/profile/keys
У клиента могут быть свои гит-репозитории на основе того же gitlab, bitbucket, github - в этих случаях необходимо перенести ssh-ключ туда.
Если хотите работать с гитом локально, то нужно перенести эти ключи и на локальную машину.
Разработчикам, не знакомым с GIT, рекомендуется перед работой ознакомиться с соответствующей документацией http://git-scm.com/book/ru/, также нужно пройти мини курс https://try.github.io/levels/1/challenges/1.

# Идентификация пользователей
Часто важно понимать, какой разработчик какой функционал делал. Чтобы это было видно в истории, необходимо ввести информацию о пользователе. Для этого есть команды:
```sh
$ git config --global user.name "John Doe"
$ git config --global user.email johndoe@example.com
```
опция global устанавливает данные пользователя глобально для всех возможных проектов. Если её не указывать, то данные будут установлены только для текущего репозитория git.

Часто какие-то изменения вносятся на серверах заказчика. Если доступ к этим серверам происходит через одного пользователя, то нет возможности различить коммиты разных разработчиков штатным способом. Поэтому на таком сервере не нужно выполнять команды, указанные выше. В таком случае стоит оставлять «подпись» в начале коммита, к примеру так: «Вася Иванов: 1853 - реализация нового функционала», или так: «Vasya Ivanov: 7361 - bugfixes».

Если пишете коммиты на русском, что предпочтительнее, проверяйте, правильно ли у вас настроена кодировка. Это можно сделать, посмотрев git log на разных машинах. Если везде ваши коммиты на русском превращаются в квакозябры, то лучше на проблемном сервере писать по-английски, или уж транслитом.

## Итого, формат коммитов следующий:
```sh
<Имя автора>: <номер таска> - <описание функционала>
```
Имя автора можно не указывать, если на проекте есть возможность коммитить под своей учеткой.

# Workflow

От проекта к проекту схема работы с git может отличаться, в зависимости от ситуации на проекте и особенностей взаимодействия с программистами заказчика. Но в целом, есть некие «best practice», к которой предлагаю стремиться. На проектах, полностью отданных нам на разработку, она обязательна к применению.

## Ветки
Виды веток на проекте:
##master## - ветка, отражающая состояние кода, который в данный момент находится на бою.
##release## - релизная ветка, в которую сливаются для тестирования и последующего релиза все остальные ветки.
##<номер задачи>_<краткое описание>## - все остальные ветки, в которых ведется работа по конкретным таскам.
Ветка master должна быть защищена от записи. Но даже если это не так по каким-либо причинам, в ветку master нельзя пушить функционал за исключением критичных случаев. С веткой master должен работать только человек, ответственный за проведение релизов.
Новые ветки для работы над задачами должны создаваться от ветки master.

